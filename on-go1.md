# 题目待定

Go语言是Google于2009年推出的静态编译型语言，旨在为开发人员提供类似
Python，Ruby一样简洁的语言环境，同时又具备C/C++一样的运行效率。作为一个
开源项目，在过去的两年多时间里，Go以社区协作的形式，不断地完善语言和标
准库的设计与实现。最终于今年三月28日发布了第一个稳定的发行版本：Go
version 1，简称Go 1。Go 1的推出，意味着Go语言和它的标准库已经进入了一个
稳定阶段。对于谨慎的开发人员来说，开发Go程序正趁当下，现在已经可以放心
地开发Go程序，不必再考虑未来语法和标准库的变化。

正如Go官方所说，Go 1的目的是发行一个稳定的Go语言实现，而非全盘修改。所
以对于已经熟悉Go的开发人员来说，Go 1与之前的版本并没有很大差异。绝大部
分修改都是对标准库命名空间的再组织。本文将介绍Go语言的一些典型设计理念，
及其在实际开发中的帮助。

## 编译效率，运行效率，开发效率

曾经那些代码，品读起来，恰似满腹经论的学者之间，细语轻声，拂琴畅谈。绝
非乌烟瘴气之下，面红耳赤地与编译器争辩。
--- Dick P. Gabriel

按照Go官方FAQ的说法，Go的出现是为了弥补其他语言在系统级开发上的缺陷。这
样一句话，难免有人会觉得，Go的诞生纯粹是几位计算机界大佬 --- Go最初的核
心开发人员包括Robert Griesemer, Robe Pike, Ken Thompson --- 在埋怨自己
的不肖后辈，并在吐槽同时，自己亲自操刀开发了这样一个语言。但更中肯地说
法，恐怕是他们在目睹和体验了Google的系统级开发之后，总结出的一套在异构，
分布式多核系统之上的生存之道。而今天Google所面临的问题，也许恰恰是几年
后每个公司的面试题目。与其说Go是一座空中楼阁，不如说是各位系统开发界大
佬进入新时代后的一部略带辛酸的开发史。

Go的几位开发人员究竟经历或目睹了哪些痛苦，我们不得而知。但从官方公布的
材料上，可以看出他们对当前系统级开发的思考：

- 如果开发人员希望获得较高的运行效率，那么可以考虑C/C++或者Java。但代
  价是降低编译效率和开发效率。
- 如果开发人员希望加快开发效率，那么可以选择Python，Ruby一类解释型语言。
  但是要以降低运行效率为代价。并可能承受弱类型带来的各种安全问题。

基于以上的思考，诞生了最初Go的设计理念：编译效率，运行效率和开发效率要
三者兼顾。使用Go开发，要让开发人员感觉到Python的便利，C/C++的运行效率，以
及小到可以被忽略的编译时间。为了实现这个理念，形成了Go语言的以下几个特性：

- 编译，静态类型语言。由此可以提供满足对运行效率敏感的系统级应用。
- 垃圾回收，去除复杂的内存释放工作。
- 简洁的符号和语法，极力减少开发人员输入的字符数。
- 平坦的类型系统，去除了复杂的继承关系。使用结构化类型系统（Structural
  type system），既简化了事前设计工作，也为未来增加抽象层提供了非侵入式
  的解决方法。
- 基于CSP模型的并行，简化了并发结构之间的通信和数据共享。为多核时代的程
  序开发打好基础。
- 比线程更轻量的goroutine，让一个线程可以执行多个并发结构。不必使用异步
  通信，就足以达到线程池与select/poll/epoll的效果。极大简化了多连接的开
  发。
- 使用一套简单的规范，开发人员不必再单独编写脚本指定依赖关系和编译流程。
  仅仅使用代码本身和go工具链，就可以处理各种依赖关系。写完代码，一条命
  令，自动下来各种依赖，直接编译/安装。无需make，autoconf，automake，
  setup.py等工具支持。
  
前两点应该是不言自明的。倘若对于垃圾回收还留有几分犹豫，不妨尝试把
``linked_ptr，scoped_ptr，shared_ptr，smart_ptr，weak_ptr，
intrusive_ptr``和``exception_ptr``之间的区别解释给Java程序员，看看他们
是否愿意转头自己收拾内存残局。

本文重点对后五点做详细分析，并给出在实际中的典型应用场景。至于集这些特
点于一身的Go究竟为开发人员带来了什么，不妨引述《C++编程思想》作者，
Bruce Eckel的话：

    现在来说，我觉得在系统级开发方面，它（Go）比C++要好上许多。使用它开
    发更高效，并能使用比C++更简单的方式解决很多问题。

## 大道至简，再现C语言辉煌

public static <I, O> ListenableFuture<O> chain (ListenableFuture<I>
input, Function<? super I, ? extends ListenableFuture<? extends O>>
function) 苍天啊！大地啊！快把这货拦下来吧！
--- 来自某聊天记录

原贝尔实验室UNIX/Plan 9开发人员Ken Thompson，Rob Pike，Russ Cox；Java
Hotspot编译器作者，Chrome V8引擎设计者Robert Griesemer；memcached作者
Brad Fitzpatrick；gold链接器作者，gcc社区活跃开发者Ian Lance Taylor……由
这样一群人组成一个团队，开发一个语言，如果说它能续写C语言的辉煌，怕也不
算痴人梦话。

但之所以让人感到Go神似C语言，并非是其背后强大的开发团队和他们与C语言千
丝万缕的联系，也不仅仅是Go对系统级开发的重视。而是简洁与实用并存的语法
让人触目难忘。在21世纪，一个严肃的通用编程语言，使用一份仅有约两万词的
语言规范，只定义25个关键字，却涵盖了并发，面向对象等方方面面，这样一个
语言对于开发人员来说，怕也足以值得一试了。

以下是一些简单的语法层面的简化：

- 没有分号了。其实Go语言规范中，Go中的语句的确是以分号做分割的。但Go语
  言规定，词法分析器使用一套规则自动地添加分号。这种对词法分析器的要求，
  带来了一条编码规范：左大括号不要单独写在一行，否则词法分析器可能会产
  生不必要的分号。虽然多了这样一条编码规范，但是带来的结果是开发人员确
  实不必考虑分号了。以Go标准库为例，其中没有任何一个语句，需要开发人员
  明确地写下分号。
- 使用:=操作符声明变量和其初始值，省去了明确指明变量类型。Go的确是强类
  型语言，每个变量都有一个固定类型。但并不意味着每次声明变量都需要把变
  量类型在键盘上敲一遍。因为如果声明的同时赋值，往往可以从初始值推断出
  变量的类型。这对于简单的类型也许并没有体现出什么优势，但试想要声明一
  个结构/类。使用Java则需要：foo.Foo a = new foo.Foo; 而Go则只需 a :=
  new(foo.Foo)。对于比较长的类型名来说，这可以减少很多打字。需要注意的
  一点是，:=操作符同时完成了变量声明和赋值的操作。如果变量之前已经声明，
  只是要给它赋值，则依然使用常见的=赋值。
- for，if的判断条件，和switch的控制语句无需括号。也就是说，可以写成
  ``if a < b { dosomething() }``。还可以写``switch b { case 1:
  dosomething() }``。
- 所有循环只有for一个关键字。而for循环有三种写法: 和C语言for循环类似的
  写法``for i := 0; i < 10; i++ { dosomething() }``，和C语言while循环
  类似的写法``for i < 100 { dosomething() }``，以及无条件循环``for {
  iteration() }``。
- switch的条件可以是表达式且可以没有控制语句。这意味着以下语句是合法的：

    switch {
    case i % 2 == 0:
        process_even(i)
    case i % 2 != 0:
        process_odd(i)
    }
	
这些看似不经意的改变，却有效的简化了程序的书写和阅读。让开发者减少打字
之外，也让读程序变得更加简单。

## 类型系统：先实现，后抽象

你先把东西实现了，不必事先考虑到全部情况。之后你也许会发现，两个实现了
相同方法名的结构，需要用一个函数来处理。这时候你只要定义一个接口，就万
事具备了。
--- Rob Pike，Google的首席工程师，Go语言作者，Plan 9及
Inferno OSes的架构师，在GOTO会议上关于Go的接口类型

## 并发，并行结构和goroutine

然而，处理器技术的发展指出，比起[掩盖了各种并行结构的]单处理器，由多个
类似的处理器（各自包含自己的存储单元）组成的多处理器计算机也许会更加强
大，可靠和经济。
-- C.A.R. Hoare，图灵奖获得者，CSP作者，于1978年

## 依赖，编译

如果Go需要一个配置文件，描述如何编译和构建Go写的程序，那就是Go的失败。
--- Go官方文档

## 效率

- Matt: 使用Pat/go后，比起（原来的）Sinatra/Ruby方案，JSON API节点效率提
升了多少？给个估计就可以。
- Blake: 大约10,000倍
- Matt: 漂亮！我能引述你的话吗？
- Blake: 我再查查，我觉得好像低估了。
--- Matt Aimonetti与Blake Mizerany在推特上的对话。

## 参考文献

- Go官方网站 http://golang.org
- Effective Go, Go官方公布的教程 http://golang.org/doc/effective_go.html
